const Me=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=o(i);fetch(i.href,s)}};Me();const Te=2,Ee=1,He=1,Be="Kival Evan#5480";class Pe{constructor(){this.version=`v${Te}.${Ee}.${He}`,this.wm=Be}get number(){return this.version}get watermark(){return this.wm}}function n(e,t=0){return t>0?Math.round(e*Math.pow(10,t))/Math.pow(10,t):Math.round(e)}function J(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const qe=e=>e*(180/Math.PI),N=e=>e*(Math.PI/180);class De{constructor(t=128){this.bpm=t}set value(t){this.bpm=t}get value(){return this.bpm}}class Ie{constructor(t,o=2){this._bpm=t,this._precBeat=o,this.update()}set precBeat(t){this._precBeat=t,this.update()}get precBeat(){return this._precBeat}set precTime(t){this.precBeat=1/t}get precTime(){return this._precTime}set precRealTime(t){this.precBeat=1/(this._bpm.value*t/6e4)}get precRealTime(){return this._precRealTime}set ebpmStream(t){this._ebpmStream=t,this.precBeat=this.calcBeatPrecision()}get ebpmStream(){return this._ebpmStream}set ebpmOHJ(t){this._ebpmStream=t/2,this.precBeat=this.calcBeatPrecision()}get ebpmOHJ(){return this._ebpmOHJ}update(){this._precTime=1/this._precBeat,this._precRealTime=60/this._bpm.value/this._precBeat*1e3,this._ebpmOHJ=this.calcEffectiveBPM(),this._ebpmStream=this._ebpmOHJ/2}calcEffectiveBPM(){return this._bpm.value*.5/(1/this._precBeat)}calcBeatPrecision(){return this._ebpmStream/(this._bpm.value*.25)}}const X=class{constructor(e,t=10,o=0){this._hjd=0,this._jd=0,this._jdMin=0,this._reactionTime=0,this._bpm=e,this._njs=t,this._sdm=o,this.update()}set njs(e){this._njs=e,this.update()}get njs(){return this._njs}set offset(e){this._sdm=e,this.update()}get offset(){return this._sdm}get hjd(){return this._hjd}get hjdMin(){return X.HJD_MIN}get reactTime(){return this._reactionTime}get jd(){return this._jd}get jdMin(){return this._jdMin}update(){this._hjd=this.calcHalfJumpDuration(),this._jd=this.calcJumpDistance(),this._jdMin=this.calcJumpDistance(X.HJD_MIN),this._reactionTime=this.calcReactionTimeHJD()}calcHalfJumpDurationRaw(){const e=18,t=this._njs*this._njs/this._njs,o=60/this._bpm.value;let r=X.HJD_START;for(;t*o*r>e;)r/=2;return r<1&&(r=1),r}calcHalfJumpDuration(e=this.offset){return Math.max(this.calcHalfJumpDurationRaw()+e,X.HJD_MIN)}calcHalfJumpDurationFromJD(e=this.calcJumpDistance()){return e/(60/this._bpm.value*this._njs*2)}calcHalfJumpDurationFromRT(e=this.calcReactionTimeHJD()){return e/(60/this._bpm.value)}calcJumpDistance(e=this.calcHalfJumpDuration()){return this._njs*(60/this._bpm.value)*e*2}calcJumpDistanceOptimalHigh(){return 18*(1/1.07)**this._njs+18}calcJumpDistanceOptimalLow(){return-(18/(this._njs+1))+18}calcReactionTimeJD(e=this.calcJumpDistance()){return e/(2*this._njs)}calcReactionTimeHJD(e=this.calcHalfJumpDuration()){return 60/this._bpm.value*e}};let ht=X;ht.HJD_START=4;ht.HJD_MIN=.25;const K={ScoreSaber:[[1,1.5],[.99,1.39],[.98,1.29],[.97,1.2],[.96,1.115],[.95,1.046],[.945,1.015],[.9,.75],[.8,.5],[.7,.285],[.68,.24],[.65,.16],[.6,.105],[.55,.06],[.5,.03],[.45,.015],[0,0]],"ScoreSaber 2020":[[1.14,1.2],[1.1,1.15],[1,1.1],[.95,1.036],[.94,.974],[.93,.92],[.92,.885],[.91,.85],[.9,.815],[.88,.766],[.86,.72],[.845,.63],[.82,.56],[.75,.425],[.69,.25],[.5,.15],[.4,.08],[0,0]]};function Je(e,t,o){return e+(t-e)*o}function Ne(e,t,o){return Oe((o-e)/(t-e))}function Oe(e,t=0,o=1){return Math.min(o,Math.max(t,e))}function we(e,t){var h,x;const o=e.map(p=>p[0]),r=e.map(p=>p[1]),i=(h=[...o].reverse().find(p=>p<=t))!=null?h:o[0],s=(x=o.find(p=>p>=t))!=null?x:i,d=r[o.indexOf(i)],g=r[o.indexOf(s)],v=Ne(i,s,t)||0;return r[o.indexOf(t)]||Je(d,g,v)}const ke=115;class Jt{constructor(t=0,o=7,r=K.ScoreSaber){this._starRating=7,this._starPP=1/1.046/.0227,this._note=t,this._starRating=o,this._curvePoints=[...r].sort((i,s)=>i[0]-s[0])}set note(t){this._note=t}get note(){return this._note}set star(t){this._starRating=t}get star(){return this._starRating}set curvePoints(t){this._curvePoints=[...t].sort((o,r)=>o[0]-r[0])}get curvePoints(){return this._curvePoints}calcPP(t=this._starRating,o=.9458064516129032){return this._starPP*t*we(this._curvePoints,o)}calcScore(t=ke,o=1,r=[],i=[]){let s=0,d=t*o,g=!0,v=0,h=1;const x=[...r].map(S=>S-1),p=[...i].map(S=>S-1);function b(){h=Math.max(h/2,1),v=0,g=!0}for(let S=0;S<this._note;S++){if(p.includes(S)&&b(),x.includes(S)){b();continue}v++,g&&v>=2*h&&(h*=2,h>=8&&(g=!1),v=0),s+=d*h}return s}}const l=new Jt(727),dt=document.querySelector("#score-input-note"),gt=document.querySelector("#score-input-star"),B=document.querySelector("#score-input-percent"),mt=document.querySelector("#score-input-score"),Nt=document.querySelector("#score-input-pp"),Fe=document.querySelector("#score-output-maxscore"),$e=document.querySelector("#score-output-maxscore-modifier"),z=document.querySelector("#score-input-avgcut"),ft=document.querySelector("#score-input-missed"),vt=document.querySelector("#score-input-break"),Ae=document.querySelector("#score-output-estscore"),Ge=document.querySelector("#score-output-estpercent"),Ve=document.querySelector("#score-output-estpp"),Xe=document.querySelector("#score-output-missscore"),Ke=document.querySelector("#score-output-nomissscore"),ze=document.querySelector("#score-output-nomisspercent"),We=document.querySelector("#score-output-nomisspp"),Ot=document.querySelector("#score-table"),bt=document.querySelector("#score-table-percentage"),Ye=document.querySelector("#score-option-pp-curve"),rt=document.querySelector("#score-text-json"),wt=document.querySelector("#score-error-json");dt.addEventListener("change",kt);dt.addEventListener("input",kt);gt.addEventListener("change",Ft);gt.addEventListener("input",Ft);B.addEventListener("change",$t);B.addEventListener("input",$t);mt.addEventListener("change",At);mt.addEventListener("input",At);z.addEventListener("change",Gt);z.addEventListener("input",Gt);vt.addEventListener("change",Vt);ft.addEventListener("change",Vt);bt.addEventListener("change",Ze);Ye.addEventListener("change",to);rt.addEventListener("change",eo);const Ue=[3,22,100,102],Qe=[127];bt.value=[100,98,97,96,95,94,93,90,85,80].join(",");dt.value=l.note.toString();gt.value=l.star.toString();B.value="90";z.value="111";ft.value=Ue.join(",");vt.value=Qe.join(",");K.custom=[...K.ScoreSaber];O();P();q();_t();function kt(e){l.note=parseInt(this.value)||0,O(),P(),q(),e.type==="change"&&(this.value=l.note.toString())}function Ft(e){l.star=parseFloat(this.value)||0,O(),P(),q(),e.type==="change"&&(this.value=n(l.star,2).toString())}function $t(e){O(),q(),e.type==="change"&&(this.value=n(parseFloat(this.value),2).toString())}function At(e){const t=parseInt(this.value),o=l.calcScore();B.value=n(t/o*100,2).toString(),Nt.value=n(l.calcPP(l.star,parseFloat(B.value)/100),2).toString(),e.type==="change"&&(this.value=t.toString())}function Gt(e){P(),e.type==="change"&&(this.value=n(parseFloat(this.value),2).toString())}function Vt(){const e=this.value.trim().replace(/\s+,/,",");if(/^((\d+\.)?\d+,?)+/.test(e)||e===""){const t=e.split(",").map(o=>parseInt(o)).filter(o=>!isNaN(o)).sort((o,r)=>o-r);this.value=t.join(",").toString(),P()}}function Ze(){const e=this.value.trim().replace(/\s+,/,",");if(/^((\d+\.)?\d+,?)+/.test(e)){const t=e.split(",").map(o=>parseFloat(o)).filter(o=>!isNaN(o)).sort((o,r)=>r-o);this.value=t.toString(),q()}}function O(){mt.value=n(l.calcScore()*(parseFloat(B.value)/100)).toString(),Nt.value=n(l.calcPP(l.star,parseFloat(B.value)/100),2).toString(),Fe.textContent=J(l.calcScore()),$e.textContent=J(l.calcScore())}function P(){const e=ft.value.split(",").map(s=>parseInt(s))||[],t=vt.value.split(",").map(s=>parseInt(s))||[],o=l.calcScore(),r=l.calcScore(parseFloat(z.value),void 0,e,t),i=l.calcScore(parseFloat(z.value));Ae.textContent=J(n(r)),Ge.textContent=n(r/o*100,2).toString(),Ve.textContent=n(l.calcPP(l.star,r/o),2).toString(),Xe.textContent=J(n(i-r)),Ke.textContent=J(n(i)),ze.textContent=n(i/o*100,2).toString(),We.textContent=n(l.calcPP(l.star,i/o),2).toString()}function q(){Ot.innerHTML="<tr><th>Percentage</th><th>Score</th><th>PP</th></tr>";const e=bt.value.split(",").map(t=>parseFloat(t));for(let t=0;t<e.length;t++){let o=document.createElement("tr"),r=document.createElement("td"),i=document.createElement("td"),s=document.createElement("td");r.textContent=n(e[t],2).toString(),i.textContent=J(n(l.calcScore()*(e[t]/100))),s.textContent=n(l.calcPP(l.star,e[t]/100),2).toString(),o.appendChild(r),o.appendChild(i),o.appendChild(s),Ot.appendChild(o)}}function to(){l.curvePoints=K[this.value],rt.disabled=!0,this.value==="custom"&&(rt.disabled=!1),O(),P(),q(),_t()}function eo(){let e={};wt.innerHTML="";try{/^{/.test(this.value.trim())?e=JSON.parse(this.value.trim()):e=JSON.parse(`{${this.value.trim().replace(/\,$/,"")}}`),l.curvePoints=e.curvePoints,K.custom=e.curvePoints}catch(t){console.error(t),wt.innerHTML=t+"<br>"}O(),P(),q(),_t()}function _t(){const e={curvePoints:[...l.curvePoints].reverse()};rt.value=JSON.stringify(e,null,4)}class Xt{constructor(){this._difficulty={easy:null,normal:null,hard:null,expert:null,expertplus:null}}get difficulty(){return this._difficulty}calcDifference(t,o){return(1-this._difficulty[o]/this._difficulty[t])*100}getTotalReduction(){let t,o;for(const r in this._difficulty){const i=r;this._difficulty[i]!=null&&((!t||t<this._difficulty[i])&&(t=this._difficulty[i]),(!o||o>this._difficulty[i])&&(o=this._difficulty[i]))}return t||t&&o?(1-o/t)*100:0}}const M=new Xt,Kt={},St={};for(const e in M.difficulty)Kt[e]=document.querySelector(`#sps-input-${e}`),St[e]=document.querySelector(`#sps-output-${e}`);const oo=document.querySelector("#sps-output-total-reduction");for(const e in M.difficulty)Kt[e].addEventListener("input",ro);function ro(e){const t=this.id.slice(10);M.difficulty[t]=this.value?Math.abs(parseFloat(this.value.trim())):null;let o=null;for(const r in M.difficulty){const i=r;M.difficulty[i]!==null&&(o!==null&&(St[o].textContent=`${M.difficulty[i]!==0?M.calcDifference(i,o).toFixed(2):"Infinity"}%`),o=i),St[i].textContent=""}oo.textContent=`${M.getTotalReduction().toFixed(2)}%`,e.type==="change"&&M.difficulty[t]!==null&&(this.value=n(M.difficulty[t],2).toString())}const nt=e=>[e.r,e.g,e.b],zt=e=>{let t=e[0],o=e[1],r=e[2],i,s,d;return t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=(t*.4124+o*.3576+r*.1805)/.95047,s=(t*.2126+o*.7152+r*.0722)/1,d=(t*.0193+o*.1192+r*.9505)/1.08883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,[116*s-16,500*(i-s),200*(s-d)]},Wt=(e,t)=>{let o=0;return e>=0&&t===0?0:e<0&&t===0?180:e===0&&t>0?90:e===0&&t<0?270:(e>0&&t>0&&(o=0),e<0&&(o=180),e>0&&t<0&&(o=360),qe(Math.atan(t/e))+o)},Ct=(e,t)=>{const[o,r,i]=zt(e),[s,d,g]=zt(t),v=1,h=1,x=1;let p,b,S,A,pt,C,y,L,_,G,Et,Ht,Bt,Pt,qt,Dt,It,V,I,R;return p=Math.sqrt(r*r+i*i),b=Math.sqrt(d*d+g*g),S=(p+b)/2,pt=.5*(1-Math.sqrt((S^7)/((S^7)+(25^7)))),_=(1+pt)*r,p=Math.sqrt(_*_+i*i),C=Wt(_,i),_=(1+pt)*d,b=Math.sqrt(_*_+g*g),y=Wt(_,g),V=s-o,I=b-p,p*b==0?R=0:(_=n(y-C,12),Math.abs(_)<=180?R=y-C:_>180?R=y-C-360:R=y-C+360),R=2*Math.sqrt(p*b)*Math.sin(N(R/2)),G=(o+s)/2,A=(p+b)/2,p*b==0?L=C+y:(_=Math.abs(n(C-y,12)),_>180?y+C<360?L=C+y+360:L=C+y-360:L=C+y,L/=2),Et=1-.17*Math.cos(N(L-30))+.24*Math.cos(N(2*L))+.32*Math.cos(N(3*L+6))-.2*Math.cos(N(4*L-63)),qt=30*Math.exp(-((L-275)/25)*((L-275)/25)),Dt=2*Math.sqrt((A^7)/((A^7)+(25^7))),Ht=1+.015*((G-50)*(G-50))/Math.sqrt(20+(G-50)*(G-50)),Bt=1+.045*A,Pt=1+.015*A*Et,It=-Math.sin(N(2*qt))*Dt,V=V/(v*Ht),I=I/(h*Bt),R=R/(x*Pt),Math.sqrt(V*V+I*I+R*R+It*I*R)},yt={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.706,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_obstacleColor:{r:.9921569,g:0,b:.7719755},_envColorLeftBoost:{r:.754717,g:.3610244,b:.22071921},_envColorRightBoost:{r:0,g:.7058824,b:1}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},"New World":{_colorLeft:{r:.625,g:.625,b:.625},_colorRight:{r:.34375,g:.4375,b:.625},_envColorLeft:{r:.21875,g:.28125,b:.46875},_envColorRight:{r:.5,g:.5625,b:.78125},_obstacleColor:{r:.625,g:.59375,b:.8125}},"Girly Cupid":{_colorLeft:{r:1,g:.1875,b:.1875},_colorRight:{r:.375,g:.5625,b:.875},_envColorLeft:{r:.375,g:.375,b:.375},_envColorRight:{r:.625,g:.75,b:.875},_obstacleColor:{r:.75,g:.75,b:.75}},"T.R.Y Revolution":{_colorLeft:{r:1,g:0,b:.375},_colorRight:{r:.125,g:.375,b:.90625},_envColorLeft:{r:1,g:.125,b:.375},_envColorRight:{r:.1875,g:.5625,b:1},_obstacleColor:{r:.625,g:.625,b:.625}},Frightmare:{_colorLeft:{r:.8125,g:.125,b:.125},_colorRight:{r:.625,g:.625,b:.625},_envColorLeft:{r:.625,g:.03215,b:.03215},_envColorRight:{r:.71875,g:.71875,b:.71875},_obstacleColor:{r:.1875,g:.1875,b:.1875}},"Azure Raindrop":{_colorLeft:{r:.8125,g:.125,b:.125},_colorRight:{r:.0625,g:.5,b:.875},_envColorLeft:{r:.5625,g:.5625,b:.5625},_envColorRight:{r:.0625,g:.5,b:.875},_obstacleColor:{r:.75,g:.25,b:.75}},"werewolf howls.":{_colorLeft:{r:.812,g:.125,b:.125},_colorRight:{r:.25,g:.5,b:.75},_envColorLeft:{r:.875,g:.062,b:.062},_envColorRight:{r:.375,g:.375,b:.375},_envColorLeftBoost:{r:.938,g:.062,b:.062},_envColorRightBoost:{r:.938,g:.438,b:0},_obstacleColor:{r:.25,g:.25,b:.25}},VENTEN:{_colorLeft:{r:.8125,g:.625,b:.375},_colorRight:{r:.625,g:.375,b:.875},_envColorLeft:{r:.78125,g:.625,b:.1875},_envColorRight:{r:.09375,g:.4375,b:.6875},_envColorLeftBoost:{r:.875,g:.0625,b:.375},_envColorRightBoost:{r:.1875,g:.5,b:.875},_obstacleColor:{r:.125,g:.25,b:.4375}},"Unconscious Requiem":{_colorLeft:{r:.312,g:.312,b:.312},_colorRight:{r:.419,g:.625,b:.213},_envColorLeft:{r:.85,g:.085,b:.085},_envColorRight:{r:.604,g:.604,b:.604},_envColorLeftBoost:{r:.922,g:.596,b:.255},_envColorRightBoost:{r:.259,g:.784,b:.02},_obstacleColor:{r:.5,g:.5,b:.5}},"Pure-Hearted Armeria":{_colorLeft:{r:.25,g:.25,b:.25},_colorRight:{r:.625,g:.625,b:.625},_envColorLeft:{r:.25,g:.562,b:.312},_envColorRight:{r:.562,g:.562,b:.562},_obstacleColor:{r:.25,g:.5,b:.375},_envColorLeftBoost:{r:.625,g:.188,b:.188},_envColorRightBoost:{r:.125,g:.312,b:.688}}};class Yt{constructor(t="Default Custom"){this._environmentColor=t,this._colorScheme={_colorLeft:null,_colorRight:null,_envColorLeft:null,_envColorRight:null,_envColorLeftBoost:null,_envColorRightBoost:null,_obstacleColor:null},this.update()}get colorScheme(){return this._colorScheme}get environmentColor(){return this._environmentColor}set environmentColor(t){this._environmentColor=t,this.update()}update(){if(yt[this._environmentColor])for(const t in this._colorScheme){const o=t;this._colorScheme[o]=yt[this._environmentColor][o]||null}}getColorHex(t){return t==null?"#000000":this.rgbaToHex(t)}decToHex(t){let o=t.toString(16);return o.length===1?"0"+o:o}hexToDec(t){return parseInt(t,16)}cDenorm(t){return t>1&&!(t<0)?255:n(t*255)}cNorm(t){return t/255}rgbaToHex(t){let o={r:0,g:0,b:0};for(const r in t){const i=r;typeof t[i]=="number"&&(o[i]=this.cDenorm(t[i]))}return`#${this.decToHex(o.r)}${this.decToHex(o.g)}${this.decToHex(o.b)}`}hexToRGB(t){return{r:this.cNorm(this.hexToDec(t.slice(1,3))),g:this.cNorm(this.hexToDec(t.slice(3,5))),b:this.cNorm(this.hexToDec(t.slice(5,7)))}}}const a=new Yt,Lt=document.querySelector("#cp-option-colorscheme"),T={},E={},H={},j={};for(const e in a.colorScheme){const t=e.replace(/^\_/,"").toLowerCase();T[e]=document.querySelector(`#cp-input-hex-${t}`),E[e]=document.querySelector(`#cp-input-picker-${t}`),H[e]=document.querySelector(`#cp-input-include-${t}`),j[e]=document.querySelector(`#cp-input-reset-${t}`)}const Ut=document.querySelector("#cp-output-de-nc"),Qt=document.querySelector("#cp-output-de-la"),Zt=document.querySelector("#cp-output-de-ra"),te=document.querySelector("#cp-io-colorjson"),ee=document.querySelector("#cp-error-colorjson");Lt.addEventListener("change",no);for(const e in a.colorScheme)T[e].addEventListener("change",co),E[e].addEventListener("change",so),H[e].addEventListener("click",lo),j[e].addEventListener("click",ao),j[e].style.display="none";const Rt="Custom";let D=document.createElement("option");D.value=Rt;D.textContent=Rt;Lt.append(D);for(const e in yt)D=document.createElement("option"),D.value=e,D.textContent=e,Lt.append(D);te.addEventListener("change",io);function no(){if(this.value!==Rt){for(const e in a.colorScheme)T[e].value="",E[e].value="#000000",H[e].checked=!1,j[e].style.display="none";a.environmentColor=this.value;for(const e in a.colorScheme){const t=e;if(a.colorScheme[t]){const o=a.getColorHex(a.colorScheme[t]);T[t].value=o,E[t].value=o,H[t].checked=!!a.colorScheme[t],j[t].style.display="block"}}w(),k()}}function io(){for(const o in a.colorScheme)T[o].value="",E[o].value="#000000",H[o].checked=!1,j[o].style.display="none";ee.innerHTML="";const e=["_colorLeft","_colorRight","_envColorLeft","_envColorRight","_envColorLeftBoost","_envColorRightBoost","_obstacleColor"];let t={};try{/^{/.test(this.value.trim())?t=JSON.parse(this.value.trim()):t=JSON.parse(`{${this.value.trim().replace(/\,$/,"")}}`)}catch(o){console.error(o),ee.innerHTML=o+"<br>"}for(const o in t){const r=o;if(e.includes(r)){a.colorScheme[r]=t[r];const i=a.getColorHex(t[r]);T[r].value=i,E[r].value=i,H[r].checked=!0,j[r].style.display="block"}}w(),k()}function w(){const e=a.colorScheme._colorLeft,t=a.colorScheme._colorRight,o=[1,1,1];e?Qt.textContent=n(Ct(nt(e),o),2).toString():Qt.textContent="N/A",t?Zt.textContent=n(Ct(nt(t),o),2).toString():Zt.textContent="N/A",e&&t?Ut.textContent=n(Ct(nt(e),nt(t)),2).toString():Ut.textContent="N/A"}function k(){const e={};for(const t in a.colorScheme){const o=t;H[o].checked&&(e[o]=a.colorScheme[o])}te.value=JSON.stringify(e,null,4)}function co(){if(/^\#?[0-9a-fA-F]{6,8}/.test(this.value.trim())){let e=`_${this.id.slice(13)}`;for(const o in a.colorScheme)e===o.toLowerCase()&&(e=o);const t=this.value.trim().replace(/^\#?/,"#").slice(0,7);a.colorScheme[e]=a.hexToRGB(t),T[e].value=t,E[e].value=t,H[e].checked=!0,j[e].style.display="block",w(),k()}}function so(){let e=`_${this.id.slice(16)}`;for(const t in a.colorScheme)e===t.toLowerCase()&&(e=t);a.colorScheme[e]=a.hexToRGB(this.value),T[e].value=this.value,H[e].checked=!0,j[e].style.display="block",w(),k()}function lo(){let e=`_${this.id.slice(17)}`;for(const t in a.colorScheme)e===t.toLowerCase()&&(e=t);this.checked&&(a.colorScheme[e]=a.hexToRGB(E[e].value),T[e].value=E[e].value,j[e].style.display="block"),w(),k()}function ao(){let e=`_${this.id.slice(15)}`;for(const t in a.colorScheme)e===t.toLowerCase()&&(e=t);a.colorScheme[e]=null,T[e].value="",E[e].value="#000000",H[e].checked=!1,j[e].style.display="none",w(),k()}const W={0:"noter.svg",1:"noteb.svg",2:"bomb.png",3:"noterd.svg",4:"notebd.svg",blank:"blank.png"},oe={0:"",1:"deg180",2:"deg270",3:"deg90",4:"deg315",5:"deg45",6:"deg225",7:"deg135",8:""};class re{constructor(t,o){this._maxIndex=o,this._maxLayer=t}set column(t){this._maxIndex=t}get column(){return this._maxIndex}set row(t){this._maxLayer=t}get row(){return this._maxLayer}set limit(t){this._limit=t}get limit(){return this._limit}set total(t){this._total=t}get total(){return this._total}set noteRed(t){this._noteRed=t}get noteRed(){return this._noteRed}set noteBlue(t){this._noteBlue=t}get noteBlue(){return this._noteBlue}set noteBomb(t){this._noteBomb=t}get noteBomb(){return this._noteBomb}set noDot(t){this._noDot=t}get noDot(){return this._noDot}set parity(t){this._parity=t}get parity(){return this._parity}set parityExtend(t){this._parityExtend=t}get parityExtend(){return this._parityExtend}set parityRed(t){this._parityRed=t}get parityRed(){return this._parityRed}set parityBlue(t){this._parityBlue=t}get parityBlue(){return this._parityBlue}createValidParity(t=0,o=!1){const r={0:{0:[6,1,7],1:[4,0,5],2:[0,1,2,3,4,5,6,7,8],3:[0,1,2,3,4,5,6,7,8]},1:{0:[6,1,7],1:[4,0,5],2:[0,1,2,3,4,5,6,7,8],3:[0,1,2,3,4,5,6,7,8]}};return o&&(r[0][0].push(8),r[0][1].push(8),r[1][0].push(8),r[1][1].push(8)),t>0&&(r[0][0].push(3),r[0][1].push(2),r[1][0].push(2),r[1][1].push(3)),t>1&&(r[0][0].push(5),r[0][1].push(6),r[1][0].push(4),r[1][1].push(7)),t>2&&(r[0][0].push(0,2),r[0][1].push(1,3),r[1][0].push(0,3),r[1][1].push(1,2)),r}generate(){let t=2;const o=[this._noteRed,this._noteBlue,this._noteBomb],r={0:this._parityRed?0:1,1:this._parityBlue?0:1},i=this.createValidParity(this._parityExtend,!this._noDot),s=this._maxIndex*this._maxLayer;this._limit&&(t=Math.min(this._total,o.reduce((g,v)=>g+v),s)),this._limit||(t=Math.min(o.reduce((g,v)=>g+v),s));const d=new Array(s).fill(null);if(t===0)return d;for(let g=0;g<t;){let v=Math.floor(Math.random()*s),h=Math.floor(Math.random()*3);for(let p=0;p<3;p++)o[h]===0&&(h=(h+1)%3);if(o[h]===0)break;let x=Math.floor(Math.random()*9);this._parity&&h<=1&&(x=i[h][r[h]][Math.floor(Math.random()*i[h][r[h]].length)]);for(let p=0;p<s;p++){let b=(v+p)%s;if(d[b]===null){h===2&&(x=0),d[b]={_noteType:h,_noteDirection:x},o[h]--,g++;break}}}return d}}const m=new re(3,4),ne=document.querySelector("#rpg-input-rpattern-row"),ie=document.querySelector("#rpg-input-rpattern-column"),ce=document.querySelector("#rpg-table-rpattern"),se=document.querySelector("#rpg-input-rpattern-red"),le=document.querySelector("#rpg-input-rpattern-blue"),ae=document.querySelector("#rpg-input-rpattern-bomb"),uo=document.querySelector("#rpg-input-rpattern-limit"),ue=document.querySelector("#rpg-input-rpattern-total"),pe=document.querySelector("#rpg-input-rpattern-nodot"),po=document.querySelector("#rpg-input-rpattern-parity"),he=document.querySelector("#rpg-input-rpattern-parity-extend"),ho=document.querySelector("#rpg-input-rpattern-parity-red"),go=document.querySelector("#rpg-input-rpattern-parity-blue"),mo=document.querySelector("#rpg-input-generate-rpattern");ne.addEventListener("click",fo);ie.addEventListener("click",vo);mo.addEventListener("click",bo);ne.value=m.row.toString();ie.value=m.column.toString();se.value="1";le.value="1";ae.value="0";ue.value="2";he.value="0";jt();function jt(){ce.innerHTML="";for(let e=0;e<m.row;e++){let t=document.createElement("tr");for(let o=0;o<m.column;o++){let r=document.createElement("td");r.className="table-grid";let i=document.createElement("img");i.className="table-rpattern-image",i.src=`./assets/${W.blank}`,i.alt=W.blank.slice(0,-4),r.appendChild(i),t.appendChild(r)}ce.appendChild(t)}}function fo(){const e=Math.min(Math.abs(parseFloat(this.value))||1,4);this.value=e.toString(),m.row=e,jt()}function vo(){const e=Math.min(Math.abs(parseFloat(this.value))||1,8);this.value=e.toString(),m.column=e,jt()}function bo(){const e=document.querySelectorAll(".table-rpattern-image");e.forEach(o=>{o.src="./assets/blank.png",o.alt="blank",o.className="table-rpattern-image"}),m.noteRed=parseInt(se.value)||0,m.noteBlue=parseInt(le.value)||0,m.noteBomb=parseInt(ae.value)||0,m.noDot=pe.checked,m.limit=uo.checked,m.total=parseInt(ue.value)||0,m.parity=po.checked,m.parityExtend=parseInt(he.value)||0,m.parityRed=ho.checked,m.parityBlue=go.checked;const t=m.generate();for(let o=0;o<t.length;o++)t[o]!==null&&(e[o].src=`./assets/${t[o]._noteDirection!==8||pe.checked?W[t[o]._noteType]:W[t[o]._noteType+3]}`,e[o].alt=W[t[o]._noteType].slice(0,-4),t[o]._noteDirection!==8&&(e[o].className+=` ${oe[t[o]._noteDirection]}`,e[o].alt+=` ${oe[t[o]._noteDirection]}`))}const f=new De,c=new ht(f,16),u=new Ie(f);new Jt(727);new Xt;new Yt;new re(3,4);const de=new Pe,_o=document.querySelectorAll(".text-version"),So=document.querySelectorAll(".text-watermark"),xt=document.querySelector("#map-settings-input-bpm"),ge=document.querySelectorAll(".toggle-input"),Y=document.querySelector("#ebpm-input-precbeat"),U=document.querySelector("#ebpm-input-prectime"),F=document.querySelector("#ebpm-input-precrealtime"),it=document.querySelector("#ebpm-input-ebpm-ohj"),ct=document.querySelector("#ebpm-input-ebpm-stream"),st=document.querySelector("#njs-input-njs"),$=document.querySelector("#njs-input-offset"),Q=document.querySelector("#njs-input-hjd"),Z=document.querySelector("#njs-input-jd"),tt=document.querySelector("#njs-input-reacttime"),lt=document.querySelector("#njs-output-jd"),me=document.querySelector("#njs-output-reacttime"),Co=document.querySelector("#njs-output-jd-optimal-high"),yo=document.querySelector("#njs-output-jd-optimal-low"),Lo=document.querySelector("#njs-output-reverse-staircase"),Ro=document.querySelector("#njs-output-reverse-staircase-time"),jo=document.querySelector("#njs-output-reverse-staircase-diagonal"),xo=document.querySelector("#njs-output-reverse-staircase-diagonal-time"),Mo=document.querySelector("#njs-output-inline"),To=document.querySelector("#njs-output-inline-time"),fe=document.querySelector("#njs-option-njs-scale"),Eo=document.querySelector("#label-input-text"),Mt=document.querySelector("#label-output-text"),Ho=document.querySelector("#label-input-diff-count-1"),Bo=document.querySelector("#label-input-diff-count-2"),Po=document.querySelector("#label-input-diff-count-3"),qo=document.querySelector("#label-input-diff-count-4"),Do=document.querySelector("#label-input-diff-count-5");xt.addEventListener("change",be);xt.addEventListener("input",be);Y.addEventListener("change",_e);Y.addEventListener("input",_e);U.addEventListener("change",Se);U.addEventListener("input",Se);F.addEventListener("change",Ce);F.addEventListener("input",Ce);it.addEventListener("change",at);it.addEventListener("input",at);ct.addEventListener("change",at);ct.addEventListener("input",at);st.addEventListener("change",ye);st.addEventListener("input",ye);$.addEventListener("change",Le);$.addEventListener("input",Le);Q.addEventListener("change",Re);Q.addEventListener("input",Re);Z.addEventListener("change",je);Z.addEventListener("input",je);tt.addEventListener("change",xe);tt.addEventListener("input",xe);Eo.addEventListener("input",Oo);Ho.addEventListener("click",ot);Bo.addEventListener("click",ot);Po.addEventListener("click",ot);qo.addEventListener("click",ot);Do.addEventListener("click",ot);Io(de.number);Jo(de.watermark);xt.value=f.value.toString();et();Tt();st.value=c.njs.toString();$.value=c.offset.toString();ut();me.textContent=`${n(60/f.value*c.hjdMin*1e3)}ms`;ve();function Io(e){_o.forEach(t=>{t.textContent=e})}function Jo(e){So.forEach(t=>{t.textContent=e})}function ve(){ge.forEach(e=>{e.disabled=!1})}function No(){ge.forEach(e=>{e.disabled=!0})}function be(e){f.value=Math.abs(parseFloat(this.value))||0,f.value>0?(u.update(),ve(),Tt(),et(),ut(),me.textContent=`${n(60/f.value*c.hjdMin*1e3)}ms`):No(),e.type==="change"&&(this.value=f.value.toString())}function _e(e){u.precBeat=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):1,u.precBeat>0&&(et(),U.value=n(u.precTime,3).toString(),F.value=n(u.precRealTime,1).toString()),e.type==="change"&&(this.value=n(u.precBeat,3).toString())}function Se(e){u.precTime=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):1,u.precTime>0&&(et(),Y.value=n(u.precBeat,3).toString(),F.value=n(u.precRealTime,1).toString()),e.type==="change"&&(this.value=n(u.precTime,3).toString())}function Ce(e){u.precRealTime=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):1,u.precRealTime>0&&(et(),Y.value=n(u.precBeat,3).toString(),U.value=n(u.precTime,3).toString()),e.type==="change"&&(F.value=n(u.precRealTime,1).toString())}function at(e){this.id==="ebpm-input-ebpm-ohj"&&(u.ebpmOHJ=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):f.value,e.type==="change"&&(this.value=n(u.ebpmOHJ,2).toString()),ct.value=n(u.ebpmStream,2).toString()),this.id==="ebpm-input-ebpm-stream"&&(u.ebpmStream=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):f.value,e.type==="change"&&(this.value=n(u.ebpmStream,2).toString()),it.value=n(u.ebpmOHJ,2).toString()),Tt()}function Tt(){Y.value=n(u.precBeat,3).toString(),U.value=n(u.precTime,3).toString(),F.value=n(u.precRealTime,1).toString()}function et(){it.value=n(u.ebpmOHJ,2).toString(),ct.value=n(u.ebpmStream,2).toString()}function ye(e){c.njs=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):c.njs,ut(),e.type==="change"&&(this.value=n(c.njs,3).toString())}function Le(e){c.offset=parseFloat(this.value)||0,ut(),e.type==="change"&&(this.value=n(c.offset,3).toString())}function Re(e){c.offset=Math.max(Math.abs(parseFloat(this.value)),c.hjdMin)-c.calcHalfJumpDurationRaw(),$.value=n(c.offset,3).toString(),Z.value=n(c.jd,3).toString(),tt.value=n(c.reactTime*1e3).toString(),lt.textContent=n(c.jdMin,2).toString(),e.type==="change"&&(this.value=n(c.hjd,3).toString())}function je(e){let t=Math.abs(parseFloat(this.value))>0?Math.abs(parseFloat(this.value)):c.jd;fe.value==="hjd"&&(t=Math.max(t,c.jdMin),c.offset=c.calcHalfJumpDurationFromJD(t)-c.calcHalfJumpDurationRaw()),fe.value==="njs"&&(c.njs=t/(2*c.calcReactionTimeHJD())),Q.value=n(c.hjd,3).toString(),tt.value=n(c.reactTime*1e3).toString(),lt.textContent=n(c.jdMin,2).toString(),st.value=n(c.njs,3).toString(),$.value=n(c.offset,3).toString(),e.type==="change"&&(this.value=n(c.jd,2).toString())}function xe(e){let t=Math.max(Math.abs(parseFloat(this.value))/1e3>0?Math.abs(parseFloat(this.value))/1e3:c.calcReactionTimeHJD(),c.calcReactionTimeHJD(c.hjdMin));c.offset=t/(60/f.value)-c.calcHalfJumpDurationRaw(),Q.value=n(c.hjd,3).toString(),Z.value=n(c.jd,2).toString(),lt.textContent=n(c.jdMin,2).toString(),$.value=n(c.offset,3).toString(),e.type==="change"&&(this.value=n(c.reactTime*1e3).toString())}function ut(){c.update(),Q.value=n(c.hjd,3).toString(),Z.value=n(c.jd,2).toString(),tt.value=n(c.reactTime*1e3).toString(),Co.textContent=n(c.calcJumpDistanceOptimalHigh(),2).toString(),yo.textContent=n(c.calcJumpDistanceOptimalLow(),2).toString(),Lo.textContent=n((1.425/c.njs-.0216882353)*(f.value/60),3).toString(),Ro.textContent=n(1/((1.425/c.njs-.0216882353)*(f.value/60)),1).toString(),jo.textContent=n((1.425/c.njs-.03414823529)*(f.value/60),3).toString(),xo.textContent=n(1/((1.425/c.njs-.03414823529)*(f.value/60)),1).toString(),Mo.textContent=n(1.425/c.njs*(f.value/60),3).toString(),To.textContent=n(1/(1.425/c.njs*(f.value/60)),1).toString(),lt.textContent=n(c.jdMin,2).toString()}function Oo(){this.value.trim()!==""?Mt.textContent=this.value.trim():Mt.textContent="none"}function ot(){Mt.className=`diff-label diff-count-${parseInt(this.value)}`}
